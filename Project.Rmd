---
title: "36-600-A_Project_1"
author: "Aaditya Hari Nair"
date: "2024-09-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The first step to EDA is to import the dataset into the programming language of choice otherwise you can't perform EDA. 
In this step I also added all libraries that are going to be used during this entire Markdown file
I installed a package called hot.deck. In this package there is a function called is.discrete which basically tells whether a given data is discrete or not this is done by checking if there are more than 10 unique values. If there are not more than 10 unique values then it can be said that the given data is discrete as in there is only a finite set of values that each point in the data frame can fit into.

```{r}
df<-read.csv("cmu-sleep.csv")
suppressMessages(library(hot.deck))
suppressMessages(library(tidyverse))
suppressMessages(library(corrplot))
summary(df)
head(df)
for (i in names(df)){
  if(is.discrete(df[i])==TRUE){
   print(i)
    }
}
```

In the above cell I have added all the dependencies that 
From this we can see that there are some discrete columns in our table that means that these columns don't have too many values. These columns are study, cohort, demo_race, demo_gender and demo_firstgen.


```{r}
sapply(df, function(x) sum(is.na(x)))
```
As it can be seen that term_units and zterm_units_ZofZ are both having a lot of null value we could drop these two rows. This is because of the fact that there are around 634 observations and if we were to remove 147 rows of this data it could cause some problems as the size fo the dataset is already so small. 
On top of that we also know that they are continuous variables making them difficult to easily impute with accurate values this is because of the fact that those points can become a little bit skewed.
Also rather than removing the row that has the demo_race and demo_gender row I have imputed it with the median value as the number that is missing is so low that it will not cause major skewing. Also on top that both values can be seen to be discrete variables. Which means that I can't take the mean value and replace it with that because of the fact then there will be definite problems that could arise.
I also found that the cohort column is a character column which is going to make it difficult to find the correlation matrix for the dataset. Also the reason we can replace the values with integers is because of the fact that the cohort column is a discrete column which means that there is only a finite set of values and there is no range of values.
After doing all of this I then check again if there are any null values present in the dataset. 

```{r}
library(tidyr)
head(df)
df = subset(df, select = -c(term_units, Zterm_units_ZofZ, subject_id))
df$demo_race[is.na(df$demo_race)] <- median(df$demo_race,na.rm = TRUE)
df$demo_gender[is.na(df$demo_gender)] <- median(df$demo_gender,na.rm = TRUE)
df$demo_firstgen[is.na(df$demo_firstgen)] <- median(df$demo_firstgen,na.rm = TRUE)
df$cohort<-  as.integer(factor(df$cohort))
sapply(df, function(x) sum(is.na(x)))
head(df)
```

```{r}
field<-setdiff(names(df), c("study", "cohort", "demo_race", "demo_gender", "demo_firstgen"))
df.quant <- gather(select(df, field))
ggplot(data=df.quant,mapping=aes(x=value)) +
  geom_histogram(fill="deepskyblue3",bins=30) +
  facet_wrap(~key,scales='free')
```
From these graphs it can be seen that some of the values in the graph are not present which is causing some skewing in the data. In the first graph it can be seen that a lot of the responses in that tab is that people have not missed a single bedtime. This is causing the graph to come out as very skewed towards the left. 
Now to plot the graphs of those values that are discrete
```{r}
disc<- setdiff(names(df), field)
df.disc <- gather(df %>% select(disc))
ggplot(data=df.disc,mapping=aes(x=value)) +
  geom_bar(fill="deeppink3") +
  facet_wrap(~key,scales='free')
```

From this graph it can be seen that there are very few rows that have a value of 2 in demo_firstgen.
Therefore it could be proposed that all rows in the table wherein which the demo_firstgen is 2 can be dropped.
```{r}
df.new<-scale(df)
correl<- cor(df.new)
corrplot(correl, method = "square")
corrplot(correl, method = "number")
```
```

I have done two visualizations of the correlation matrix. One of them is the correlation matrix which uses the square method to actually use the visual properties of a graph to be able to better understand it.
I have done a secondary graph which has numbers this is so that I can get a better understanding of the correlation values of each column with the other columns.


